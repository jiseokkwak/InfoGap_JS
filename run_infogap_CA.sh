#!/bin/bash
python3 -m train.adversarial_training_InfoGap_0118-FARE-CA \
  --clip_model_name ViT-B-32 \
  --pretrained openai \
  --dataset imagenet \
  --imagenet_root /home/aailab/data/ImageNet2012 \
  --template std \
  --output_normalize False \
  --steps 20000 \
  --warmup 1400 \
  --batch_size 128 \
  --loss l2 \
  --opt adamw \
  --lr 1e-4 \
  --disc_lr_coeff 0.2 \
  --wd 1e-4 \
  --attack pgd \
  --inner_loss ce \
  --norm linf \
  --eps 4 \
  --iterations_adv 6 \
  --stepsize_adv 1 \
  --wandb False \
  --output_dir /home/aailab/kwakjs/InfoGap/RobustVLM/checkpoint \
  --log_freq 1000 \
  --eval_freq 10000 \
  --lambda_val 1 \
  --beta1 0.9 \
  --dropout 0.2 \
  --disc_wd_coeff 10 \
  --grad_clip True \
  --leaky_relu 0.1 \
  --disc_wu_coeff 0 \
  --temperature 1 \
  --devices 2,3 \
  --second_term_coeff 1 \
  --use_gp True \
  --FARE False \
  --lambda_type 'grad_aware' \
  --regul 'neymanchi' \
  --shell_script_path /home/aailab/kwakjs/InfoGap/RobustVLM/run_infogap_CA.sh \
  --disc_mlp_dim 512
